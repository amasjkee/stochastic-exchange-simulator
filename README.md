### Проект: **Симуляция и Анализ Стохастической Биржи**

Идея проекта — построить минималистичную, но гибкую симуляцию биржевой торговли, где множество агентов с различными стратегиями взаимодействуют на общем рынке. Цель — исследовать, какие статистические и стохастические эффекты (волатильность, тренды, кластеризация, всплески активности) могут возникать из их коллективного поведения.

### Этап 1. Базовая структура рынка

1. **Основные сущности.**
   Формализовать ключевые объекты:

   * **Заявка (Order):** ID, цена, объем, сторона (покупка/продажа), время выставления.
   * **Агент (Trader):** ID, стратегия, баланс, объём актива, память о предыдущих шагах.
   * **Рынок (Market):** совокупность активных заявок (стакан), история сделок, текущая цена.

   Цель — получить минимальную, но полную модель, где можно наблюдать и анализировать причинно-следственные связи между поведением агентов и рыночными паттернами.

2. **Стакан заявок (Order Book).**
   Два упорядоченных множества заявок — на покупку и продажу.
   Рыночная цена в каждый момент — это цена последней сделки либо точка пересечения лучших бидов и асков.

3. **Механизм сведения сделок.**
   Проверять новые заявки на возможность исполнения. При совпадении условий — фиксировать сделку, обновлять цены, баланс агентов и ликвидность рынка.

4. **Основной цикл симуляции.**
   Каждый временной шаг:

   * активируются все агенты (в зависимости от вероятности или стратегии);
   * формируются и обрабатываются их ордера;
   * совершаются сделки и обновляются состояния всех участников;
   * сохраняются метрики: последняя цена, объём торгов, распределение ликвидности.

### Этап 2. Визуализация и управление процессом

1. **Интерактивная панель управления.**
   Возможность запускать, останавливать и перезапускать симуляцию, управлять скоростью и длительностью торгов.

2. **Графическая визуализация:**

   * динамический график изменения цены во времени (аналог свечного графика);
   * визуализация стакана в виде горизонтального гистограммы (объёмы на каждом уровне цены);
   * распределение капитала агентов во времени (показывает концентрацию богатства и эффект «вымывания» слабых игроков).

3. **Наблюдение в реальном времени.**
   Возможность визуально оценивать реакции агентов на изменение рынка и взаимное влияние стратегий.

### Этап 3. Расширение агентской модели

Добавить больше разнообразия в поведение, чтобы система проявляла сложные эффекты:

1. **Шумовой трейдер (Noise Trader).**
   Случайные заявки с заданным распределением параметров. Обеспечивает базовую стохастичность рынка.

2. **Маркет-мейкер (Market Maker).**
   Поддерживает ликвидность, выставляя симметричные ордера вокруг текущей цены. Контролирует спред и уменьшает ценовые скачки.

3. **Трендовый трейдер (Trend Follower).**
   Покупает при росте цены и продаёт при падении. Усиливает тренды и порождает автокорреляцию доходностей.

4. **Контртрендовый трейдер (Contrarian).**
   Делает противоположное тренду — продаёт при росте, покупает при падении. Вносит стабилизирующий эффект.

5. **Фундаментальный трейдер.**
   Сравнивает текущую рыночную цену с «внутренней» оценкой актива. Покупает, если цена ниже справедливой, и наоборот.

6. **Арбитражёр.**
   Использует различия между двумя моделируемыми активами или рынками. Проверяет гипотезу о том, как арбитраж влияет на волатильность и ликвидность.

7. **HFT-агент (высокочастотный трейдер).**
   Работает на коротких временных горизонтах, мгновенно реагируя на микроколебания цены. Может приводить к всплескам объёмов и флеш-крэшам.

### Этап 4. Аналитическая часть и машинное обучение

1. **Анализ временного ряда цены.**
   Исследовать автокорреляции, распределение волатильности, наличие кластеризации (через условную дисперсию).
   Применить модели временных рядов (ARIMA, GARCH) для проверки схожести с реальными рыночными данными.

2. **Распределение доходностей.**
   Построить распределение логарифмических доходностей и сравнить его с нормальным.
   Проверить наличие “тяжёлых хвостов” и асимметрии, характерных для эмпирических данных.

3. **Эмпирические зависимости.**
   Изучить корреляцию между активностью агентов и метриками рынка (волатильностью, объёмом, ликвидностью).
   Проверить законы степенного типа (power laws) в распределении размеров сделок и интервалов между ними.

4. **Машинное обучение для анализа динамики.**

   * **Clustering:** применить `FindClusters` или `ClusteringComponents` к временным окнам рыночных состояний для выделения типичных режимов (спокойный, волатильный, панический).
   * **Anomaly Detection:** `FindAnomalies` для поиска редких событий — резких обвалов или скачков.
   * **Dimensionality Reduction:** `FeatureExtraction` и `DimensionReduce` для визуализации фазового пространства рынка.
   * **Predictive Modeling:** построить модель прогноза краткосрочного направления цены на основе данных симуляции (`Predict`, `Classify`).

5. **Параметрический эксперимент.**
   Организовать систематическое изменение параметров модели (например, доля HFT, число маркет-мейкеров, чувствительность трендовых трейдеров).
   С помощью `Table` или `ParallelTable` провести серию симуляций и визуализировать зависимости метрик рынка от параметров (`ListContourPlot`, `3DPlot`).

6. **Метрики устойчивости рынка.**
   Определить количественные показатели, такие как:

   * средняя и условная волатильность;
   * коэффициент Джини по распределению капитала (концентрация богатства);
   * время восстановления после шока;
   * частота флеш-крэшей.

### Этап 5. Интерпретация и представление результатов

1. **Структурирование проекта.**
   Разделить ноутбук на логические блоки:

   * описание модели и математических предпосылок;
   * реализация ядра симуляции;
   * реализация агентов;
   * визуализация рынка;
   * анализ данных и интерпретация результатов.

2. **Выводы и обсуждение.**
   Для каждого эксперимента — кратко описывать наблюдения: как поведение агентов отражается на рынке, какие закономерности возникают, когда система становится нестабильной.

3. **Финальная визуализация.**
   Подобрать набор иллюстраций:

   * динамика цены;
   * структура стакана;
   * распределение доходностей;
   * карта состояний рынка (через кластеризацию или редукцию размерности);
   * зависимость волатильности от параметров.


   Это демонстрация того, как из микроповедения множества агентов (даже простых) рождаются макропаттерны, аналогичные наблюдаемым в реальных финансовых рынках.
